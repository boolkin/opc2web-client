OPC2WEB client программа, которая подключается к указанному в конфиге (opc2web-client.exe.config) OPC DA серверу, собирает необходимые теги (те что указаны в файле tags.txt), и возвращает их значения с учетом коэффициента и смещения в виде JSON строки по указанному в конфиге порту. То есть открыв в браузере страницу 127.0.0.1:45455 (45455 - это номер порта из конфига) можно увидеть значения всех тегов из файла tags.txt. Для того чтобы отображение тегов в браузере было удобочитаемым, необходимо создать вебстраницу c использованием AJAX, которая будет забирать теги с локального хоста и отображать их в браузере. Например как тут https://github.com/boolkin/opc2web

Для удобства добавления тегов, можно все теги OPC сервера считать в один файл при помощи программы https://github.com/boolkin/OPC-TagsList и потом копировать нужные в файл tags.txt


Формат файла tags.txt - это 5 столбцов разделенных табуляцией (его можно осткрыть и в экселе):

№п/п	Тег в OPC	Коэффициент	Оффсет	Булевый тип


Соответсвенно и добавляются теги таким же образом:

0	[R04_15294_Z]zzz_test	0,5	0	b

1 столбец - номер по порядку от нуля (0)

2 столбец - название тега, так как его видят OPC клиенты ([R04_15294_Z]zzz_test)

3 столбец - коэффициент или Gain на который умножается число. Дробная часть отделяется запятой а не точкой. Перед цифрой ставить минус если отрицательный например -5 без пробела (0,5)

4 столбец - смещение или Offset которое прибавляется к числу. Можно использовать как положительное, так и отрицательное смещение (0)

5 столбец - признак булевого типа - b - означает bool (1 = true,0 = false) !b - то же но с обратной логикой (0 = true, 1 = false), s - single формат, t - текстовый формат.

Все столбцы обязательны к заполнению, иначе не получится распарсить данные.

После добавления всех необходимых строк с тегами сохраняем файл и перезапускаем службу opc2web, новые теги автоматически подтянутся.

При появлении текстовых файлов с ошибками в папке с программой, можно открыть его и посмотреть что могло привести к ошибке: на данный момент пока обрабатываются только 2 исключения - неверный формат коэффициента или офсета (точка вместо запятой или любой неизвестный символ в том числе и пробел), а также неверное количество столбцов в строке или не разделены табуляцией, может быть лишняя строка в конце


Чтобы посмотреть список тегов, можно воспользоваться любым OPC клиентом, например скачать бесплатно отсюда https://www.kassl.de/opc/download.shtml

Проверить работу клиента, можно при помощи симулятора OPC сервера, например, GrayBox http://gray-box.net/download_graysim.php?lang=ru

Чтобы получить доступ к тегам из любого компьютера внутри сети, нужно на компьютере где запущен этот клиент установить HTTP сервер, например, nginx https://nginx.org/ru/download.html
